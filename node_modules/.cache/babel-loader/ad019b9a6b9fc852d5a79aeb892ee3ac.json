{"ast":null,"code":"import _Tooltip from \"antd/lib/tooltip\";\nimport _Dropdown from \"antd/lib/dropdown\";\nimport _Avatar from \"antd/lib/avatar\";\nimport _Input from \"antd/lib/input\";\nimport _Icon from \"antd/lib/icon\";\nimport _Menu from \"antd/lib/menu\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _Layout from \"antd/lib/layout\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { useState, useCallback } from 'react';\nimport getConfig from 'next/config';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'next/router';\nimport axios from 'axios';\nimport Link from 'next/link';\nimport { logout as _logout } from '../store/store';\nvar Header = _Layout.Header,\n    Content = _Layout.Content,\n    Footer = _Layout.Footer;\nimport Container from './Container';\n\nvar _getConfig = getConfig(),\n    publicRuntimeConfig = _getConfig.publicRuntimeConfig; //style写在外边原因：githubIconStyle 保证对象为同一个 避免重新渲染\n\n\nvar githubIconStyle = {\n  color: 'white',\n  fontSize: 40,\n  display: 'block',\n  paddingTop: 10,\n  marginRight: 20\n};\nvar footerStyle = {\n  textAlign: 'center'\n}; // const Comp = ({ color, children, style }) => <div style={{ color, ...style }}>{children}</div>\n\nfunction MyLayout(_ref) {\n  var children = _ref.children,\n      user = _ref.user,\n      logout = _ref.logout,\n      router = _ref.router;\n  var urlQuery = router.query && router.query.query;\n\n  var _useState = useState(urlQuery || ''),\n      _useState2 = _slicedToArray(_useState, 2),\n      search = _useState2[0],\n      setSearch = _useState2[1]; //保证刷新后输入框与链接query一致 设置默认值\n\n\n  var handleSearchChange = useCallback(function (event) {\n    setSearch(event.target.value);\n  }, [setSearch]);\n  var handleOnSearch = useCallback(function () {\n    router.push(\"/search?query=\".concat(search));\n  }, [search]);\n  var handleLogout = useCallback(function () {\n    logout();\n  }, [logout]); // const handleGoToOAuth = useCallback(e => {\n  //   e.preventDefault();  //取消默认跳转\n  //   axios.get(`prepare-auth?url=${router.asPath}`)\n  //     .then(resp => {\n  //       if (resp.status === 200) {\n  //         location.href = publicRuntimeConfig.OAUTH_URL\n  //       } else {\n  //         console.log('prepare auth failed', resp);\n  //       }\n  //     }).catch(err => {\n  //       console.log('prepare auth failed', err)\n  //     })\n  // }, [])  //[]表示不依赖任何state和props的内容\n\n  var userDropDown = /*#__PURE__*/React.createElement(_Menu, null, /*#__PURE__*/React.createElement(_Menu.Item, null, /*#__PURE__*/React.createElement(\"a\", {\n    onClick: handleLogout\n  }, \"\\u767B\\u51FA\")));\n  return /*#__PURE__*/React.createElement(_Layout, null, /*#__PURE__*/React.createElement(Header, null, /*#__PURE__*/React.createElement(Container, {\n    renderer: /*#__PURE__*/React.createElement(\"div\", {\n      className: \"jsx-2614626269\" + \" \" + \"header-inner\"\n    })\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2614626269\" + \" \" + \"header-left\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2614626269\" + \" \" + \"logo\"\n  }, /*#__PURE__*/React.createElement(Link, {\n    href: \"/\"\n  }, /*#__PURE__*/React.createElement(_Icon, {\n    type: \"github\",\n    style: githubIconStyle\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2614626269\"\n  }, /*#__PURE__*/React.createElement(_Input.Search, {\n    placeholder: \"\\u641C\\u7D22\\u4ED3\\u5E93\",\n    value: search,\n    onChange: handleSearchChange,\n    onSearch: handleOnSearch\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2614626269\" + \" \" + \"header-right\"\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2614626269\" + \" \" + \"user\"\n  }, user && user.id ? /*#__PURE__*/React.createElement(_Dropdown, {\n    overlay: userDropDown\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"/\",\n    className: \"jsx-2614626269\"\n  }, /*#__PURE__*/React.createElement(_Avatar, {\n    size: 40,\n    src: user.avatar_url\n  }))) : /*#__PURE__*/React.createElement(_Tooltip, {\n    title: \"\\u70B9\\u51FB\\u8FDB\\u884C\\u767B\\u5F55\"\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"prepare-auth?url=\".concat(router.asPath),\n    className: \"jsx-2614626269\"\n  }, /*#__PURE__*/React.createElement(_Avatar, {\n    size: 40,\n    icon: \"user\"\n  }))))))), /*#__PURE__*/React.createElement(Content, null, /*#__PURE__*/React.createElement(Container, null, children)), /*#__PURE__*/React.createElement(Footer, {\n    style: footerStyle\n  }, \"develop by JinYoMo@\", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"https://github.com/JinYoMo/coco-github\",\n    className: \"jsx-2614626269\"\n  }, \"coco-github\")), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"1225665645\"\n  }, [\".header-inner.jsx-2614626269{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}\", \".header-left.jsx-2614626269{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;}\"]), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"3824429241\"\n  }, [\"#__next{height:100%;}\", \".ant-layout{min-height:100%;}\", \".ant-layout-header{padding-left:0;padding-right:0;}\", \".ant-layout-content{background:#fff;}\"]));\n} //export default 必须是一个函数 connect返回的就是函数\n\n\nexport default connect(function mapState(state) {\n  return {\n    user: state.user\n  };\n}, function mapReducer(dispatch) {\n  return {\n    logout: function logout() {\n      return dispatch(_logout());\n    }\n  };\n})(withRouter(MyLayout));","map":null,"metadata":{},"sourceType":"module"}