{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Row from \"antd/lib/row\";\nimport _Pagination from \"antd/lib/pagination\";\nimport _Col from \"antd/lib/col\";\nimport _List from \"antd/lib/list\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nimport { memo, isValidElement, useEffect } from 'react';\nimport { withRouter } from 'next/router';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport Repo from '../components/Repo'; // import { cacheArray } from '../lib/repo-basic-cache'\n\nvar api = require('../lib/api');\n\nvar LANGUAGES = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Rust'];\nvar SORT_TYPES = [{\n  name: 'Best Match'\n}, {\n  name: 'Most Stars',\n  value: 'stars',\n  order: 'desc'\n}, {\n  name: 'Fewest Stars',\n  value: 'stars',\n  order: 'asc'\n}, {\n  name: 'Most Forks',\n  value: 'forks',\n  order: 'desc'\n}, {\n  name: 'Fewest Forks',\n  value: 'forks',\n  order: 'asc'\n}];\n/**\r\n * sort: 排序方式\r\n * order: 排序顺序\r\n * lang: 仓库的项目开发主语言\r\n * page：分页页面\r\n */\n\nvar selectedItemStyle = {\n  borderLeft: '2px solid #e36209',\n  fontWeight: 100\n};\n\nfunction noop() {}\n\nvar per_page = 20;\nvar isServer = typeof window === 'undefined';\nvar FilterLink = memo(function (_ref) {\n  var name = _ref.name,\n      query = _ref.query,\n      lang = _ref.lang,\n      sort = _ref.sort,\n      order = _ref.order,\n      page = _ref.page;\n  var queryString = \"?query=\".concat(query);\n  if (lang) queryString += \"&lang=\".concat(lang);\n  if (sort) queryString += \"&sort=\".concat(sort, \"&order=\").concat(order || 'desc');\n  if (page) queryString += \"&page=\".concat(page);\n  queryString += \"&per_page=\".concat(per_page);\n  return /*#__PURE__*/React.createElement(Link, {\n    href: \"/search\".concat(queryString)\n  }, isValidElement(name) ? name : /*#__PURE__*/React.createElement(\"a\", null, name));\n});\n\nfunction Search(_ref2) {\n  var router = _ref2.router,\n      repos = _ref2.repos;\n\n  var querys = _extends({}, router.query);\n\n  var _router$query = router.query,\n      lang = _router$query.lang,\n      sort = _router$query.sort,\n      order = _router$query.order,\n      page = _router$query.page; // useEffect(() => {\n  //   if (!isServer) cacheArray(repos.items)\n  // })\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2060511232\" + \" \" + \"root\"\n  }, /*#__PURE__*/React.createElement(_Row, {\n    gutter: 20\n  }, /*#__PURE__*/React.createElement(_Col, {\n    span: 6\n  }, /*#__PURE__*/React.createElement(_List, {\n    bordered: true,\n    header: /*#__PURE__*/React.createElement(\"span\", {\n      className: \"jsx-2060511232\" + \" \" + \"list-header\"\n    }, \"\\u8BED\\u8A00\"),\n    style: {\n      marginBottom: 20\n    },\n    dataSource: LANGUAGES,\n    renderItem: function renderItem(item) {\n      var selected = lang === item;\n      return /*#__PURE__*/React.createElement(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"jsx-2060511232\"\n      }, item) : /*#__PURE__*/React.createElement(FilterLink, _extends({}, querys, {\n        lang: item,\n        name: item\n      })));\n    }\n  }), /*#__PURE__*/React.createElement(_List, {\n    bordered: true,\n    header: /*#__PURE__*/React.createElement(\"span\", {\n      className: \"jsx-2060511232\" + \" \" + \"list-header\"\n    }, \"\\u6392\\u5E8F\"),\n    dataSource: SORT_TYPES,\n    renderItem: function renderItem(item) {\n      var selected = false;\n\n      if (item.name === 'Best Match' && !sort) {\n        selected = true;\n      } else if (item.value === sort && item.order === order) {\n        selected = true;\n      }\n\n      return /*#__PURE__*/React.createElement(_List.Item, {\n        style: selected ? selectedItemStyle : null\n      }, selected ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"jsx-2060511232\"\n      }, item.name) : /*#__PURE__*/React.createElement(FilterLink, _extends({}, querys, {\n        sort: item.value,\n        order: item.order,\n        name: item.name\n      })));\n    }\n  })), /*#__PURE__*/React.createElement(_Col, {\n    span: 18\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"jsx-2060511232\" + \" \" + \"repos-title\"\n  }, repos.total_count, \" \\u4E2A\\u4ED3\\u5E93\"), repos.items.map(function (repo) {\n    return /*#__PURE__*/React.createElement(Repo, {\n      repo: repo,\n      key: repo.id\n    });\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"jsx-2060511232\" + \" \" + \"pagination\"\n  }, /*#__PURE__*/React.createElement(_Pagination, {\n    pageSize: per_page,\n    current: Number(page) || 1,\n    total: 1000,\n    onChange: noop,\n    itemRender: function itemRender(page, type, ol) {\n      var p = type === 'page' ? page : type === 'prev' ? page - 1 : page + 1;\n      var name = type === 'page' ? page : ol;\n      return /*#__PURE__*/React.createElement(FilterLink, _extends({}, querys, {\n        page: p,\n        name: name\n      }));\n    }\n  })))), /*#__PURE__*/React.createElement(_JSXStyle, {\n    id: \"2060511232\"\n  }, \".root.jsx-2060511232{padding:20px 0;}.list-header.jsx-2060511232{font-weight:800;font-size:16px;}.repos-title.jsx-2060511232{border-bottom:1px solid #eee;font-size:24px;line-height:50px;}.pagination.jsx-2060511232{padding:20px;text-align:center;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkU6XFzkuKrkurrpobnnm65cXGdpdEh1YumhueebrlxcY29jby1naXRodWJcXHBhZ2VzXFxzZWFyY2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBc0prQixBQUcwQixBQUdDLEFBSWEsQUFLaEIsYUFDSyxFQVpwQixDQUdpQixhQUlBLEVBSGpCLEFBU0EsYUFMbUIsaUJBQ25CIiwiZmlsZSI6IkU6XFzkuKrkurrpobnnm65cXGdpdEh1YumhueebrlxcY29jby1naXRodWJcXHBhZ2VzXFxzZWFyY2guanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtZW1vLCBpc1ZhbGlkRWxlbWVudCwgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnXHJcbmltcG9ydCB7IHdpdGhSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcidcclxuaW1wb3J0IHsgUm93LCBDb2wsIExpc3QsIFBhZ2luYXRpb24gfSBmcm9tICdhbnRkJ1xyXG5pbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnXHJcbmltcG9ydCBSb3V0ZXIgZnJvbSAnbmV4dC9yb3V0ZXInXHJcblxyXG5pbXBvcnQgUmVwbyBmcm9tICcuLi9jb21wb25lbnRzL1JlcG8nXHJcbi8vIGltcG9ydCB7IGNhY2hlQXJyYXkgfSBmcm9tICcuLi9saWIvcmVwby1iYXNpYy1jYWNoZSdcclxuXHJcbmNvbnN0IGFwaSA9IHJlcXVpcmUoJy4uL2xpYi9hcGknKVxyXG5cclxuY29uc3QgTEFOR1VBR0VTID0gWydKYXZhU2NyaXB0JywgJ0hUTUwnLCAnQ1NTJywgJ1R5cGVTY3JpcHQnLCAnSmF2YScsICdSdXN0J11cclxuY29uc3QgU09SVF9UWVBFUyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiAnQmVzdCBNYXRjaCcsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiAnTW9zdCBTdGFycycsXHJcbiAgICB2YWx1ZTogJ3N0YXJzJyxcclxuICAgIG9yZGVyOiAnZGVzYycsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiAnRmV3ZXN0IFN0YXJzJyxcclxuICAgIHZhbHVlOiAnc3RhcnMnLFxyXG4gICAgb3JkZXI6ICdhc2MnLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ01vc3QgRm9ya3MnLFxyXG4gICAgdmFsdWU6ICdmb3JrcycsXHJcbiAgICBvcmRlcjogJ2Rlc2MnLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ0Zld2VzdCBGb3JrcycsXHJcbiAgICB2YWx1ZTogJ2ZvcmtzJyxcclxuICAgIG9yZGVyOiAnYXNjJyxcclxuICB9LFxyXG5dXHJcblxyXG4vKipcclxuICogc29ydDog5o6S5bqP5pa55byPXHJcbiAqIG9yZGVyOiDmjpLluo/pobrluo9cclxuICogbGFuZzog5LuT5bqT55qE6aG555uu5byA5Y+R5Li76K+t6KiAXHJcbiAqIHBhZ2XvvJrliIbpobXpobXpnaJcclxuICovXHJcblxyXG5jb25zdCBzZWxlY3RlZEl0ZW1TdHlsZSA9IHtcclxuICBib3JkZXJMZWZ0OiAnMnB4IHNvbGlkICNlMzYyMDknLFxyXG4gIGZvbnRXZWlnaHQ6IDEwMCxcclxufVxyXG5cclxuZnVuY3Rpb24gbm9vcCgpIHt9XHJcblxyXG5jb25zdCBwZXJfcGFnZSA9IDIwXHJcblxyXG5jb25zdCBpc1NlcnZlciA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnXHJcbmNvbnN0IEZpbHRlckxpbmsgPSBtZW1vKCh7IG5hbWUsIHF1ZXJ5LCBsYW5nLCBzb3J0LCBvcmRlciwgcGFnZSB9KSA9PiB7XHJcbiAgbGV0IHF1ZXJ5U3RyaW5nID0gYD9xdWVyeT0ke3F1ZXJ5fWBcclxuICBpZiAobGFuZykgcXVlcnlTdHJpbmcgKz0gYCZsYW5nPSR7bGFuZ31gXHJcbiAgaWYgKHNvcnQpIHF1ZXJ5U3RyaW5nICs9IGAmc29ydD0ke3NvcnR9Jm9yZGVyPSR7b3JkZXIgfHwgJ2Rlc2MnfWBcclxuICBpZiAocGFnZSkgcXVlcnlTdHJpbmcgKz0gYCZwYWdlPSR7cGFnZX1gXHJcblxyXG4gIHF1ZXJ5U3RyaW5nICs9IGAmcGVyX3BhZ2U9JHtwZXJfcGFnZX1gXHJcblxyXG4gIHJldHVybiAoXHJcbiAgICA8TGluayBocmVmPXtgL3NlYXJjaCR7cXVlcnlTdHJpbmd9YH0+XHJcbiAgICAgIHtpc1ZhbGlkRWxlbWVudChuYW1lKSA/IG5hbWUgOiA8YT57bmFtZX08L2E+fVxyXG4gICAgPC9MaW5rPlxyXG4gIClcclxufSlcclxuXHJcbmZ1bmN0aW9uIFNlYXJjaCh7IHJvdXRlciwgcmVwb3MgfSkge1xyXG4gIGNvbnN0IHsgLi4ucXVlcnlzIH0gPSByb3V0ZXIucXVlcnlcclxuICBjb25zdCB7IGxhbmcsIHNvcnQsIG9yZGVyLCBwYWdlIH0gPSByb3V0ZXIucXVlcnlcclxuXHJcbiAgLy8gdXNlRWZmZWN0KCgpID0+IHtcclxuICAvLyAgIGlmICghaXNTZXJ2ZXIpIGNhY2hlQXJyYXkocmVwb3MuaXRlbXMpXHJcbiAgLy8gfSlcclxuXHJcbiAgcmV0dXJuIChcclxuICAgIDxkaXYgY2xhc3NOYW1lPVwicm9vdFwiPlxyXG4gICAgICA8Um93IGd1dHRlcj17MjB9PlxyXG4gICAgICAgIDxDb2wgc3Bhbj17Nn0+XHJcbiAgICAgICAgICA8TGlzdFxyXG4gICAgICAgICAgICBib3JkZXJlZFxyXG4gICAgICAgICAgICBoZWFkZXI9ezxzcGFuIGNsYXNzTmFtZT1cImxpc3QtaGVhZGVyXCI+6K+t6KiAPC9zcGFuPn1cclxuICAgICAgICAgICAgc3R5bGU9e3sgbWFyZ2luQm90dG9tOiAyMCB9fVxyXG4gICAgICAgICAgICBkYXRhU291cmNlPXtMQU5HVUFHRVN9XHJcbiAgICAgICAgICAgIHJlbmRlckl0ZW09e2l0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gbGFuZyA9PT0gaXRlbVxyXG5cclxuICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxyXG4gICAgICAgICAgICAgICAgICB7c2VsZWN0ZWQgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+e2l0ZW19PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgICAgIDxGaWx0ZXJMaW5rIHsuLi5xdWVyeXN9IGxhbmc9e2l0ZW19IG5hbWU9e2l0ZW19IC8+XHJcbiAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICA8L0xpc3QuSXRlbT5cclxuICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgICAgPExpc3RcclxuICAgICAgICAgICAgYm9yZGVyZWRcclxuICAgICAgICAgICAgaGVhZGVyPXs8c3BhbiBjbGFzc05hbWU9XCJsaXN0LWhlYWRlclwiPuaOkuW6jzwvc3Bhbj59XHJcbiAgICAgICAgICAgIGRhdGFTb3VyY2U9e1NPUlRfVFlQRVN9XHJcbiAgICAgICAgICAgIHJlbmRlckl0ZW09e2l0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgIGxldCBzZWxlY3RlZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PT0gJ0Jlc3QgTWF0Y2gnICYmICFzb3J0KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZCA9IHRydWVcclxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0udmFsdWUgPT09IHNvcnQgJiYgaXRlbS5vcmRlciA9PT0gb3JkZXIpIHtcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAgICAgPExpc3QuSXRlbSBzdHlsZT17c2VsZWN0ZWQgPyBzZWxlY3RlZEl0ZW1TdHlsZSA6IG51bGx9PlxyXG4gICAgICAgICAgICAgICAgICB7c2VsZWN0ZWQgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+e2l0ZW0ubmFtZX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgPEZpbHRlckxpbmtcclxuICAgICAgICAgICAgICAgICAgICAgIHsuLi5xdWVyeXN9XHJcbiAgICAgICAgICAgICAgICAgICAgICBzb3J0PXtpdGVtLnZhbHVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgb3JkZXI9e2l0ZW0ub3JkZXJ9XHJcbiAgICAgICAgICAgICAgICAgICAgICBuYW1lPXtpdGVtLm5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgIDwvTGlzdC5JdGVtPlxyXG4gICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgfX1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgPC9Db2w+XHJcbiAgICAgICAgPENvbCBzcGFuPXsxOH0+XHJcbiAgICAgICAgICA8aDMgY2xhc3NOYW1lPVwicmVwb3MtdGl0bGVcIj57cmVwb3MudG90YWxfY291bnR9IOS4quS7k+W6kzwvaDM+XHJcbiAgICAgICAgICB7cmVwb3MuaXRlbXMubWFwKHJlcG8gPT4gKFxyXG4gICAgICAgICAgICA8UmVwbyByZXBvPXtyZXBvfSBrZXk9e3JlcG8uaWR9IC8+XHJcbiAgICAgICAgICApKX1cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnaW5hdGlvblwiPlxyXG4gICAgICAgICAgICA8UGFnaW5hdGlvblxyXG4gICAgICAgICAgICAgIHBhZ2VTaXplPXtwZXJfcGFnZX1cclxuICAgICAgICAgICAgICBjdXJyZW50PXtOdW1iZXIocGFnZSkgfHwgMX1cclxuICAgICAgICAgICAgICB0b3RhbD17MTAwMH1cclxuICAgICAgICAgICAgICBvbkNoYW5nZT17bm9vcH1cclxuICAgICAgICAgICAgICBpdGVtUmVuZGVyPXsocGFnZSwgdHlwZSwgb2wpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHAgPVxyXG4gICAgICAgICAgICAgICAgICB0eXBlID09PSAncGFnZScgPyBwYWdlIDogdHlwZSA9PT0gJ3ByZXYnID8gcGFnZSAtIDEgOiBwYWdlICsgMVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IHR5cGUgPT09ICdwYWdlJyA/IHBhZ2UgOiBvbFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDxGaWx0ZXJMaW5rIHsuLi5xdWVyeXN9IHBhZ2U9e3B9IG5hbWU9e25hbWV9IC8+XHJcbiAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvQ29sPlxyXG4gICAgICA8L1Jvdz5cclxuICAgICAgPHN0eWxlIGpzeD57YFxyXG4gICAgICAgIC5yb290IHtcclxuICAgICAgICAgIHBhZGRpbmc6IDIwcHggMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLmxpc3QtaGVhZGVyIHtcclxuICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7XHJcbiAgICAgICAgICBmb250LXNpemU6IDE2cHg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC5yZXBvcy10aXRsZSB7XHJcbiAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2VlZTtcclxuICAgICAgICAgIGZvbnQtc2l6ZTogMjRweDtcclxuICAgICAgICAgIGxpbmUtaGVpZ2h0OiA1MHB4O1xyXG4gICAgICAgIH1cclxuICAgICAgICAucGFnaW5hdGlvbiB7XHJcbiAgICAgICAgICBwYWRkaW5nOiAyMHB4O1xyXG4gICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgICAgIH1cclxuICAgICAgYH08L3N0eWxlPlxyXG4gICAgPC9kaXY+XHJcbiAgKVxyXG59XHJcblxyXG5TZWFyY2guZ2V0SW5pdGlhbFByb3BzID0gYXN5bmMgKHsgY3R4IH0pID0+IHtcclxuICAvLyBjb25zb2xlLmxvZyhjdHgpXHJcbiAgY29uc3QgeyBxdWVyeSwgc29ydCwgbGFuZywgb3JkZXIsIHBhZ2UgfSA9IGN0eC5xdWVyeVxyXG5cclxuICBpZiAoIXF1ZXJ5KSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICByZXBvczoge1xyXG4gICAgICAgIHRvdGFsX2NvdW50OiAwLFxyXG4gICAgICB9LFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gP3E9cmVhY3QrbGFuZ3VhZ2U6amF2YXNjcmlwdCZzb3J0PXN0YXJzJm9yZGVyPWRlc2MmcGFnZT0yXHJcblxyXG4gIGxldCBxdWVyeVN0cmluZyA9IGA/cT0ke3F1ZXJ5fWBcclxuICBpZiAobGFuZykgcXVlcnlTdHJpbmcgKz0gYCtsYW5ndWFnZToke2xhbmd9YFxyXG4gIGlmIChzb3J0KSBxdWVyeVN0cmluZyArPSBgJnNvcnQ9JHtzb3J0fSZvcmRlcj0ke29yZGVyIHx8ICdkZXNjJ31gXHJcbiAgaWYgKHBhZ2UpIHF1ZXJ5U3RyaW5nICs9IGAmcGFnZT0ke3BhZ2V9YFxyXG5cclxuICBxdWVyeVN0cmluZyArPSBgJnBlcl9wYWdlPSR7cGVyX3BhZ2V9YFxyXG5cclxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcGkucmVxdWVzdChcclxuICAgIHtcclxuICAgICAgdXJsOiBgL3NlYXJjaC9yZXBvc2l0b3JpZXMke3F1ZXJ5U3RyaW5nfWAsXHJcbiAgICB9LFxyXG4gICAgY3R4LnJlcSxcclxuICAgIGN0eC5yZXMsXHJcbiAgKVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVwb3M6IHJlc3VsdC5kYXRhLFxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgd2l0aFJvdXRlcihTZWFyY2gpXHJcbiJdfQ== */\\n/*@ sourceURL=E:\\\\\\u4E2A\\u4EBA\\u9879\\u76EE\\\\gitHub\\u9879\\u76EE\\\\coco-github\\\\pages\\\\search.js */\"));\n}\n\nSearch.getInitialProps = /*#__PURE__*/function () {\n  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref3) {\n    var ctx, _ctx$query, query, sort, lang, order, page, queryString, result;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            ctx = _ref3.ctx;\n            // console.log(ctx)\n            _ctx$query = ctx.query, query = _ctx$query.query, sort = _ctx$query.sort, lang = _ctx$query.lang, order = _ctx$query.order, page = _ctx$query.page;\n\n            if (query) {\n              _context.next = 4;\n              break;\n            }\n\n            return _context.abrupt(\"return\", {\n              repos: {\n                total_count: 0\n              }\n            });\n\n          case 4:\n            // ?q=react+language:javascript&sort=stars&order=desc&page=2\n            queryString = \"?q=\".concat(query);\n            if (lang) queryString += \"+language:\".concat(lang);\n            if (sort) queryString += \"&sort=\".concat(sort, \"&order=\").concat(order || 'desc');\n            if (page) queryString += \"&page=\".concat(page);\n            queryString += \"&per_page=\".concat(per_page);\n            _context.next = 11;\n            return api.request({\n              url: \"/search/repositories\".concat(queryString)\n            }, ctx.req, ctx.res);\n\n          case 11:\n            result = _context.sent;\n            return _context.abrupt(\"return\", {\n              repos: result.data\n            });\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nexport default withRouter(Search);","map":{"version":3,"sources":["E:/个人项目/gitHub项目/coco-github/pages/search.js"],"names":["memo","isValidElement","useEffect","withRouter","Link","Router","Repo","api","require","LANGUAGES","SORT_TYPES","name","value","order","selectedItemStyle","borderLeft","fontWeight","noop","per_page","isServer","window","FilterLink","query","lang","sort","page","queryString","Search","router","repos","querys","marginBottom","item","selected","total_count","items","map","repo","id","Number","type","ol","p","getInitialProps","ctx","request","url","req","res","result","data"],"mappings":"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","sourcesContent":["import { memo, isValidElement, useEffect } from 'react'\r\nimport { withRouter } from 'next/router'\r\nimport { Row, Col, List, Pagination } from 'antd'\r\nimport Link from 'next/link'\r\nimport Router from 'next/router'\r\n\r\nimport Repo from '../components/Repo'\r\n// import { cacheArray } from '../lib/repo-basic-cache'\r\n\r\nconst api = require('../lib/api')\r\n\r\nconst LANGUAGES = ['JavaScript', 'HTML', 'CSS', 'TypeScript', 'Java', 'Rust']\r\nconst SORT_TYPES = [\r\n  {\r\n    name: 'Best Match',\r\n  },\r\n  {\r\n    name: 'Most Stars',\r\n    value: 'stars',\r\n    order: 'desc',\r\n  },\r\n  {\r\n    name: 'Fewest Stars',\r\n    value: 'stars',\r\n    order: 'asc',\r\n  },\r\n  {\r\n    name: 'Most Forks',\r\n    value: 'forks',\r\n    order: 'desc',\r\n  },\r\n  {\r\n    name: 'Fewest Forks',\r\n    value: 'forks',\r\n    order: 'asc',\r\n  },\r\n]\r\n\r\n/**\r\n * sort: 排序方式\r\n * order: 排序顺序\r\n * lang: 仓库的项目开发主语言\r\n * page：分页页面\r\n */\r\n\r\nconst selectedItemStyle = {\r\n  borderLeft: '2px solid #e36209',\r\n  fontWeight: 100,\r\n}\r\n\r\nfunction noop() {}\r\n\r\nconst per_page = 20\r\n\r\nconst isServer = typeof window === 'undefined'\r\nconst FilterLink = memo(({ name, query, lang, sort, order, page }) => {\r\n  let queryString = `?query=${query}`\r\n  if (lang) queryString += `&lang=${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n\r\n  queryString += `&per_page=${per_page}`\r\n\r\n  return (\r\n    <Link href={`/search${queryString}`}>\r\n      {isValidElement(name) ? name : <a>{name}</a>}\r\n    </Link>\r\n  )\r\n})\r\n\r\nfunction Search({ router, repos }) {\r\n  const { ...querys } = router.query\r\n  const { lang, sort, order, page } = router.query\r\n\r\n  // useEffect(() => {\r\n  //   if (!isServer) cacheArray(repos.items)\r\n  // })\r\n\r\n  return (\r\n    <div className=\"root\">\r\n      <Row gutter={20}>\r\n        <Col span={6}>\r\n          <List\r\n            bordered\r\n            header={<span className=\"list-header\">语言</span>}\r\n            style={{ marginBottom: 20 }}\r\n            dataSource={LANGUAGES}\r\n            renderItem={item => {\r\n              const selected = lang === item\r\n\r\n              return (\r\n                <List.Item style={selected ? selectedItemStyle : null}>\r\n                  {selected ? (\r\n                    <span>{item}</span>\r\n                  ) : (\r\n                    <FilterLink {...querys} lang={item} name={item} />\r\n                  )}\r\n                </List.Item>\r\n              )\r\n            }}\r\n          />\r\n          <List\r\n            bordered\r\n            header={<span className=\"list-header\">排序</span>}\r\n            dataSource={SORT_TYPES}\r\n            renderItem={item => {\r\n              let selected = false\r\n              if (item.name === 'Best Match' && !sort) {\r\n                selected = true\r\n              } else if (item.value === sort && item.order === order) {\r\n                selected = true\r\n              }\r\n              return (\r\n                <List.Item style={selected ? selectedItemStyle : null}>\r\n                  {selected ? (\r\n                    <span>{item.name}</span>\r\n                  ) : (\r\n                    <FilterLink\r\n                      {...querys}\r\n                      sort={item.value}\r\n                      order={item.order}\r\n                      name={item.name}\r\n                    />\r\n                  )}\r\n                </List.Item>\r\n              )\r\n            }}\r\n          />\r\n        </Col>\r\n        <Col span={18}>\r\n          <h3 className=\"repos-title\">{repos.total_count} 个仓库</h3>\r\n          {repos.items.map(repo => (\r\n            <Repo repo={repo} key={repo.id} />\r\n          ))}\r\n          <div className=\"pagination\">\r\n            <Pagination\r\n              pageSize={per_page}\r\n              current={Number(page) || 1}\r\n              total={1000}\r\n              onChange={noop}\r\n              itemRender={(page, type, ol) => {\r\n                const p =\r\n                  type === 'page' ? page : type === 'prev' ? page - 1 : page + 1\r\n                const name = type === 'page' ? page : ol\r\n                return <FilterLink {...querys} page={p} name={name} />\r\n              }}\r\n            />\r\n          </div>\r\n        </Col>\r\n      </Row>\r\n      <style jsx>{`\r\n        .root {\r\n          padding: 20px 0;\r\n        }\r\n        .list-header {\r\n          font-weight: 800;\r\n          font-size: 16px;\r\n        }\r\n        .repos-title {\r\n          border-bottom: 1px solid #eee;\r\n          font-size: 24px;\r\n          line-height: 50px;\r\n        }\r\n        .pagination {\r\n          padding: 20px;\r\n          text-align: center;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  )\r\n}\r\n\r\nSearch.getInitialProps = async ({ ctx }) => {\r\n  // console.log(ctx)\r\n  const { query, sort, lang, order, page } = ctx.query\r\n\r\n  if (!query) {\r\n    return {\r\n      repos: {\r\n        total_count: 0,\r\n      },\r\n    }\r\n  }\r\n\r\n  // ?q=react+language:javascript&sort=stars&order=desc&page=2\r\n\r\n  let queryString = `?q=${query}`\r\n  if (lang) queryString += `+language:${lang}`\r\n  if (sort) queryString += `&sort=${sort}&order=${order || 'desc'}`\r\n  if (page) queryString += `&page=${page}`\r\n\r\n  queryString += `&per_page=${per_page}`\r\n\r\n  const result = await api.request(\r\n    {\r\n      url: `/search/repositories${queryString}`,\r\n    },\r\n    ctx.req,\r\n    ctx.res,\r\n  )\r\n\r\n  return {\r\n    repos: result.data,\r\n  }\r\n}\r\n\r\nexport default withRouter(Search)\r\n"]},"metadata":{},"sourceType":"module"}